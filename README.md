# EDINET APIを使用した有価証券報告書・半期報告書取得ツール

## 概要
このスクリプトは、金融庁が提供するEDINET APIを活用して、指定した証券コードの企業の有価証券報告書及び半期報告書をPDF形式で自動的に取得するツールです。

## 機能
- 指定した企業の有価証券報告書・半期報告書を自動検索
- 過去200日分のデータを対象に検索
- 検索結果をPDFファイルとして保存

## 前提条件
- EDINET APIのアクセスキーが必要です
- company_list.xlsxファイル内に取得対象企業の証券コードが記載されている必要があります

## 必要なライブラリ
```
datetime
pandas
python-dotenv
os
requests
tqdm
```

## 設定
1. `.env`ファイルを作成し、以下の形式でEDINET APIキーを記載してください：
```
API_KEY=あなたのAPIキー
```

2. `company_list.xlsx`ファイルに、取得対象企業の「証券コード」列を含めてください。

## 使用方法
1. 必要なライブラリをインストールします：
```
pip install pandas python-dotenv requests tqdm openpyxl
```

2. `.env`ファイルとcompany_list.xlsxファイルを準備します。

3. スクリプトを実行します：
```
python get_pdf.py
```

4. 実行結果として、`pdf_files`ディレクトリに「会社名+書類名」の形式でPDFファイルが保存されます。

## 処理フロー
1. 過去200日分の日付リストを生成
2. 各日付ごとにEDINET APIから指定した企業の書類情報を取得
3. 有価証券報告書または半期報告書のみをフィルタリング
4. 対象書類のPDFをダウンロードして保存

## 注意事項
- EDINET APIの利用制限に注意してください
- 大量の企業を対象とする場合は処理時間がかかる場合があります
- APIキーは公開しないように注意してください

## ライセンス
ご自由にご利用ください。

---

## 【機能追加】
- get_trends.py...取得したpdfファイルから主要な経営指標のトレンドを抽出し、CSVファイルに保存するスクリプト
- run.bat...get_pdf.pyとget_trends.pyを連続して実行するバッチファイル
